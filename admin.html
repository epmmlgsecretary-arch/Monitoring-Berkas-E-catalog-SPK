<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Sekretaris - Monitoring Berkas</title>


<style>
* { box-sizing: border-box; }


/* ===== HEADER PUTIH + WAVE ===== */
.approval-header {
  position: relative;
  background: #ffffff;
  padding: 80px 40px 0;
  overflow: hidden;
}


.approval-header-inner {
  max-width: 1300px;
  margin: 0 auto;
}


.approval-title {
  font-size: 56px;
  font-weight: 900;
  color: #8bc34a;
  margin: 0;
}


.wave-header {
  display: block;
  width: 100%;
  height: 180px;
  line-height: 0;
}


/* ===== HERO HIJAU ===== */
.approval-hero {
  background: #d9f0d5;
  padding: 80px 40px 160px;
  margin-top: -120px; /* nyambung ke wave */
}


.approval-inner {
  max-width: 1300px;
  margin: 0 auto;
}


body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #dff1d8; /* sama seperti halaman ADMIN */
  color: #333;
}


/* ===== LOGOUT ICON ===== */
.logout-btn {
  position: fixed;
  top: 26px;
  right: 32px;
  background: none;
  border: none;
  cursor: pointer;
  z-index: 50;
}
.logout-btn svg {
  width: 30px;
  height: 30px;
  stroke: #d32f2f;
}
.logout-btn:hover svg {
  stroke: #b71c1c;
}


/* ===== HERO HIJAU ===== */
.hero {
  position: relative;
  background: transparent;
  padding: 110px 40px 160px;
  overflow: hidden;
}


.hero-inner {
  max-width: 1300px;
  margin: auto;
}


.hero h1 {
  margin: 0 0 20px;
  font-size: 56px;
  font-weight: 900;
  color: #7cb342;
}


/* ================= SEARCH ================= */
.search-box {
  display: flex;
  align-items: center;
  gap: 10px;


  width: 480px;
  padding: 12px 18px;


  background: #d9f0d5;        /* hijau muda */
  border: 1.5px solid rgba(0,0,0,0.8);  /* hitam tipis */
  border-radius: 999px;


  margin: 20px 0 26px;
}


.search-icon {
  font-size: 16px;
  opacity: 0.7;
}


.search-box input {
  border: none !important;
  outline: none;
  box-shadow: none;
  background: transparent;


  width: 100%;
  font-size: 14px;
  color: #333;
}


.search-box input:focus {
  outline: none;
  box-shadow: none;
}


.search-box input::placeholder {
  color: #777;
}


/* ===== WAVE ATAS ===== */
.wave-top {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 220px; /* lebih tinggi */
}


/* ===== CONTENT ===== */
.content {
  position: relative;
  margin-top: -160px;
  padding: 0 40px 120px;
}


.container {
  background: #ffffff;
  padding: 25px 30px 35px;
  border-radius: 18px;
  box-shadow: 0 12px 28px rgba(0,0,0,0.08);
}


/* ===== TABLE ===== */
.table-wrapper {
  max-height: 520px;
  overflow-y: auto;
  border-radius: 10px;
}


table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}


th, td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}


th {
  background: #f1f1f1;
  position: sticky;
  top: 0;
  z-index: 2;
}


/* ===== FORM IN TABLE ===== */
select, input[type="text"] {
  width: 100%;
  padding: 6px;
  font-size: 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
}


/* ===== BUTTON ===== */
.action-btn {
  padding: 6px 14px;
  background: #1e4fa1;
  color: #fff;
  border: none;
  border-radius: 6px;
  font-size: 12px;
  font-weight: bold;
  cursor: pointer;
}
.action-btn:hover {
  background: #163c7a;
}


/* ===== WAVE BAWAH ===== */
.wave-bottom {
  width: 100%;
  height: 200px;
}


/* ===== TABLE HEADER ICON ===== */
.th-icon {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-weight: bold;
}


.th-icon svg {
  width: 14px;
  height: 14px;
  stroke: #000;
  stroke-width: 2;
  fill: none;
}
</style>
</head>


<body>


<!-- LOGOUT -->
<button class="logout-btn" onclick="logout()" aria-label="Keluar">
  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
    <polyline points="16 17 21 12 16 7"/>
    <line x1="21" y1="12" x2="9" y2="12"/>
  </svg>
</button>


<!-- HERO -->
<section class="hero">
  <svg class="wave-top" viewBox="0 0 1440 220" preserveAspectRatio="none">
  <path fill="#ffffff"
    d="
      M0,120
      C240,60 480,20 720,40
      C960,60 1200,120 1440,90
      L1440,0
      L0,0
      Z
    "/>
</svg>


  <div class="hero-inner">
    <h1>APPROVAL</h1>


   <div class="search-wrapper">
  <div class="search-box">
    <span class="search-icon">
      <svg
        width="18"
        height="18"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/>
        <line
          x1="16.65"
          y1="16.65"
          x2="21"
          y2="21"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
        />
      </svg>
    </span>


    <input
      id="searchInput"
      placeholder="Search"
      onkeyup="filterTable()"
    />
  </div>
</div>


</section>


<!-- CONTENT -->
<section class="content">
  <div class="container">


    <div class="table-wrapper">
      <table>
        <thead>
  <tr>
    <th>No</th>


    <th>
      <span class="th-icon">
        <!-- calendar -->
        <svg viewBox="0 0 24 24">
          <rect x="3" y="4" width="18" height="18" rx="2"/>
          <line x1="16" y1="2" x2="16" y2="6"/>
          <line x1="8" y1="2" x2="8" y2="6"/>
        </svg>
        Tanggal
      </span>
    </th>


    <th>
      <span class="th-icon">
        <!-- user -->
        <svg viewBox="0 0 24 24">
          <circle cx="12" cy="8" r="4"/>
          <path d="M4 20c2-4 14-4 16 0"/>
        </svg>
        Nama Outlet
      </span>
    </th>


    <th>
      <span class="th-icon">
        <!-- list -->
        <svg viewBox="0 0 24 24">
          <line x1="8" y1="6" x2="21" y2="6"/>
          <line x1="8" y1="12" x2="21" y2="12"/>
          <line x1="8" y1="18" x2="21" y2="18"/>
          <circle cx="4" cy="6" r="1"/>
          <circle cx="4" cy="12" r="1"/>
          <circle cx="4" cy="18" r="1"/>
        </svg>
        Online
      </span>
    </th>


    <th><span class="th-icon"># No SPK</span></th>
    <th><span class="th-icon"># No ID Paket</span></th>
    <th><span class="th-icon"># Nominal</span></th>
    <th><span class="th-icon"># No Faktur</span></th>


    <th>
      <span class="th-icon">
        <!-- user -->
        <svg viewBox="0 0 24 24">
          <circle cx="12" cy="8" r="4"/>
          <path d="M4 20c2-4 14-4 16 0"/>
        </svg>
        PIC
      </span>
    </th>


    <th>
      <span class="th-icon">
        <!-- info -->
        <svg viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="10" x2="12" y2="16"/>
          <circle cx="12" cy="7" r="1"/>
        </svg>
        Keterangan
      </span>
    </th>


    <th>
      <span class="th-icon">
        <!-- folder -->
        <svg viewBox="0 0 24 24">
          <path d="M3 6h6l2 2h10v10a2 2 0 0 1-2 2H3z"/>
        </svg>
        Locatore
      </span>
    </th>


    <th>
      <span class="th-icon">
        <!-- edit -->
        <svg viewBox="0 0 24 24">
          <path d="M3 17l4 4 14-14-4-4z"/>
        </svg>
        Aksi
      </span>
    </th>
  </tr>
</thead>
        <tbody id="body">
          <tr>
            <td colspan="12">Memuat data...</td>
          </tr>
        </tbody>
      </table>
    </div>


  </div>
</section>


<!-- WAVE BAWAH -->
<svg class="wave-bottom" viewBox="0 0 1440 200" preserveAspectRatio="none">
  <path fill="#dff1d8"
    d="M0,60 C240,120 480,140 720,120
       C960,100 1200,40 1440,80
       L1440,200 L0,200 Z"/>
</svg>


<!-- ================= JS ASLI (TIDAK DIUBAH) ================= -->
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzFVqmjdJ8S16w34juIm2DswFWg4h1YgLDfzG-hT9-uzPGBGLVNh8UrKxX1BLr4qQi_aA/exec";
const PIN = sessionStorage.getItem("role") === "admin"
  ? sessionStorage.getItem("admin_pin") || localStorage.getItem("admin_pin")
  : null;


if (!PIN) {
  alert("Akses ditolak. Silakan login terlebih dahulu.");
  window.location.href = "pin-approval.html";
}


window.onload = loadData;


function loadData() {
  fetch(API_URL + "?action=admin_list&pin=" + PIN)
    .then(r => r.json())
    .then(data => render(data));
}


function render(data) {
  const body = document.getElementById("body");
  body.innerHTML = "";
  data.forEach(r => {
    body.innerHTML += `
      <tr>
        <td>${r["No"]}</td>
        <td>${r["Tanggal"]}</td>
        <td>${r["Nama Obat"]}</td>
        <td>${r["Online / Tidak"]}</td>
        <td>${r["No SPK"]}</td>
        <td>${r["No ID Paket"]}</td>
        <td>${r["Nominal"]}</td>
        <td>${r["No Faktur"]}</td>
        <td>${r["PIC Salesman"]}</td>
        <td>
          <select id="ket_${r._row}">
            <option ${r["Keterangan"]=="PENDING"?"selected":""}>PENDING</option>
            <option ${r["Keterangan"]=="DONE"?"selected":""}>DONE</option>
            <option ${r["Keterangan"]=="REJECT"?"selected":""}>REJECT</option>
          </select>
        </td>
        <td><input type="text" id="loc_${r._row}" value="${r["Locatore"]||""}"></td>
        <td><button class="action-btn" onclick="update(${r._row})">Simpan</button></td>
      </tr>
    `;
  });
}


function update(row) {
  const ket = document.getElementById("ket_" + row).value;
  const loc = document.getElementById("loc_" + row).value;
  fetch(API_URL + "?action=admin_update&pin=" + PIN + "&row=" + row + "&keterangan=" + ket + "&locstore=" + loc)
    .then(() => alert("Data diperbarui"));
}


function logout() {
  sessionStorage.clear();
  localStorage.removeItem("admin_pin");
  window.location.href = "pin-approval.html";
}
</script>


</body>
</html>

